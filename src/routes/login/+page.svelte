<script lang="ts">
  import type { Provider } from "LoginProvider";
  import KakaoLoginBtn from "$lib/components/login/KakaoLoginBtn.svelte"; 
	import { goto } from "$app/navigation";
  // CSS ëª¨ë“ˆ ì„í¬íŠ¸
  import styles from './Login.module.css';

  const KakaoOauthProviders : Provider = {
    name: 'Kakao',
    icon: '/oauthBtn/kakaotalk_sharing_btn_medium.png',
    url: '/api/oauth/kakao/login'
  };

  /**
   * OAuth ë¡œê·¸ì¸ ì²˜ë¦¬: í˜„ì¬ ê²½ë¡œë¥¼ ì €ì¥í•˜ê³  ì œê³µëœ URLë¡œ ì´ë™í•©ë‹ˆë‹¤.
   * @param provider - ë¡œê·¸ì¸ ì œê³µì ì •ë³´
   */
  function handleLogin(provider: Provider) {
    const currentPath = window.location.pathname; 
    localStorage.setItem('redirectAfterLogin', currentPath);
    window.location.href = provider.url;
  }
</script>

<div class={styles.container}>
  <div class={styles.bgPlanet + ' ' + styles.planet1}></div>
  <div class={styles.bgPlanet + ' ' + styles.planet2}></div>
  <div class={styles.bgPlanet + ' ' + styles.planet3}></div>
  
  <div class={styles.contentWrapper}>
    <div class={styles.logoSection}>
      <div class={styles.logoCircle}>
        <span class={styles.logoEmoji}>ğŸª</span>
      </div>
      <button type="button" on:click={() => goto("/")} class={styles.logoButton}>
        <h1 class={styles.logoText}>Planet</h1> 
      </button>
      <p class={styles.tagline}>ë‹¹ì‹ ì˜ ê³„íšì´ ëª¨ì—¬ í•˜ë‚˜ì˜ í–‰ì„±ì´ ë©ë‹ˆë‹¤</p>
    </div>

    <div class={styles.loginCard}>
      <h2 class={styles.cardTitle}>ë¡œê·¸ì¸</h2>
      
      <div class={styles.welcomeText}>
        <p>ì˜¤ëŠ˜ì˜ í•  ì¼ì„ ê¸°ë¡í•˜ê³ ,</p>
        <p>ëª©í‘œë¥¼ ë‹¬ì„±í•˜ë©° ì„±ì¥í•˜ëŠ” ê³¼ì •ì„</p>
        <p>ì¹œêµ¬ë“¤ê³¼ ê³µìœ í•˜ì„¸ìš” ğŸš€</p>
      </div>

      <div class={styles.btnList}>
        <KakaoLoginBtn 
          provider={KakaoOauthProviders} 
          on:click={() => handleLogin(KakaoOauthProviders)} 
        />
      </div>

      <p class={styles.bottomText}>
        Planetì— ë¡œê·¸ì¸í•˜ì—¬<br/>
        ë‚˜ë§Œì˜ ì‘ì€ ìš°ì£¼ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš” ğŸŒŒ
      </p>
    </div>

    <div class={styles.footerText}>
      <p>Planetì— ë¡œê·¸ì¸í•˜ë©´ ì„œë¹„ìŠ¤ ì•½ê´€ ë° ê°œì¸ì •ë³´ ë³´í˜¸ì •ì±…ì—</p>
      <p>ë™ì˜í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
    </div>
  </div>
</div>